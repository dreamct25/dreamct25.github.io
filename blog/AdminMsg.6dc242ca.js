!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,a,n){Object.defineProperty(e,t,{get:a,set:n,enumerable:!0,configurable:!0})}var a=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire35b1;a.register("caVT7",function(n,s){Object.defineProperty(n.exports,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",function(){return p});var i=a("fDqVs"),r=a("2srOF"),l=a("lakWf"),c=a("3o8Nz"),m=a("ksxDn"),o=a("bW9HB"),u=a("diPDO"),g=a("cYcEi"),d=a("5OXzf"),f=a("e4nhi"),N=a("dR8pc"),E=a("7fGfG"),v=void 0,p=function(){var t,a=(0,u.useContext)(d.NewContext),n=a.$,s=a.Fetch,p=a.getReducer,h=a.rwdStatus,D=a.changeWebTitle,b=(0,g.useNavigate)(),k=p(function(e){return(0,l._)({},e.AdminLoginReducer)}).authInfo,C=(0,m._)((0,u.useState)({msgData:[],renderMsgData:[],toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},currentAction:"",useDisabled:!1,paginationObj:{}}),2),_=C[0],P=_.msgData,y=_.renderMsgData,L=_.toggleModalStatus,T=_.toggleDeleteModalStatus,M=_.currentAction,S=_.valGroups,I=_.useDisabled,x=_.paginationObj,O=C[1],w=(0,m._)((0,u.useState)(!1),2),A=w[0],j=w[1],R={hasPrev:x.hasPrev,hasNext:x.hasNext,currentPage:x.currentPage,pageTotal:x.pageTotal,pageSize:x.pageSize,partPage:x.partPage,postNext:function(e){var t=e.pages,a=e.partPage,n=e.pageSize,s=(0,f.default).createParts(P,t,a,n),i=s.pageObj,r=s.renderItem;O(function(e){return(0,c._)((0,l._)({},e),{renderMsgData:r,paginationObj:i})})}},G=function(e){return(0,m._)(e.split(" "),1)[0]},z=(t=(0,i._)(function(){return(0,o.__generator)(this,function(e){switch(e.label){case 0:return j(!0),[4,s.get("/back_view_all",{token:k.token}).then(function(e){var t=e.data;s.get("/back_msg_l_all",{token:k.token}).then(function(e){var a=n.maps(e.data,function(e){var a=n.filter(t,function(t){return t.uuid===e.articleID});return a.length>0?(0,c._)((0,l._)({},e),{articleTitle:a[0].articleTitle}):e}),s=(0,f.default).createParts(a,1,10,10),i=s.pageObj,r=s.renderItem;O(function(e){return(0,c._)((0,l._)({},e),{msgData:a,renderMsgData:r,paginationObj:i})}),j(!1)}).catch(function(){return alert("error")})}).catch(function(){return alert("error")})];case 1:return e.sent(),[2]}})}),function(){return t.apply(this,arguments)}),J=function(e,t){"DELETE"===e?O(function(a){return(0,c._)((0,l._)({},a),{currentAction:e,valGroups:t,toggleDeleteModalStatus:!0})}):O(function(a){return(0,c._)((0,l._)({},a),{currentAction:e,valGroups:t,toggleModalStatus:!0,useDisabled:"READ"===e})})},V=function(e){var t=JSON.parse(JSON.stringify(S)),a=n.findIndexOfObj(t.resContentList,function(t){return t.resMsgID===e});t.resContentList=t.resContentList.remove(a),O(function(e){return(0,c._)((0,l._)({},e),{valGroups:t})})},W=function(e,t){var a,m=!1;(0,(a={},(0,r._)(a,e,/*#__PURE__*/(0,i._)(function(){var a,i;return(0,o.__generator)(this,function(r){switch(r.label){case 0:if("confirm"!==t||!("READ"!==e))return[3,2];return a=n.formatDateTime({formatDate:new Date,formatType:"yyyy-MM-dd HH:mm:ss"}),(i=JSON.parse(JSON.stringify(S))).modifyDate=a,j(!0),[4,s.post("/update_msg_l",{token:k.token,data:i})];case 1:r.sent(),m=!0,j(!1),r.label=2;case 2:return[2]}})})),(0,r._)(a,"DELETE",/*#__PURE__*/(0,i._)(function(){var e;return(0,o.__generator)(this,function(a){switch(a.label){case 0:if("confirm"!==t)return[3,2];return e=S.mud,j(!0),[4,s.post("/delete_msg_l",{token:k.token,data:{mud:e}})];case 1:a.sent(),z(),m=!0,j(!1),a.label=2;case 2:return[2]}})})),a)[e])().finally(function(){O(function(e){return(0,c._)((0,l._)({},e),{toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},useDisabled:!1})}),m&&z()})};return(0,u.useEffect)(function(){(null==k?void 0:k.token)?z():b({pathname:"/admin/login"})},[k]),/*@__PURE__*/e(u).createElement(E.Container,null,D("後台留言管理"),/*@__PURE__*/e(u).createElement("div",{className:"msg-layout"},h?null:/*@__PURE__*/e(u).createElement("div",{className:"msg-list-header"},["留言者","留言內容","留言文章","留言 / 修改日期","操作項"].map(function(t,a){return /*@__PURE__*/e(u).createElement("div",{key:a},t)})),/*@__PURE__*/e(u).createElement("div",{className:"msg-list"},0===y.length?/*@__PURE__*/e(u).createElement("div",{className:"no-data"},"-- 無留言 --"):y.map(function(t,a){return h?/*@__PURE__*/e(u).createElement("div",{key:a,className:"msg-list-item"},/*@__PURE__*/e(u).createElement("div",{className:"top"},/*@__PURE__*/e(u).createElement("div",{className:"left"},/*@__PURE__*/e(u).createElement("div",null,"留言者"),/*@__PURE__*/e(u).createElement("div",null,"留言內容"),/*@__PURE__*/e(u).createElement("div",null,"留言文章"),/*@__PURE__*/e(u).createElement("div",null,"留言 / 修改日期")),/*@__PURE__*/e(u).createElement("div",{className:"right"},/*@__PURE__*/e(u).createElement("div",null,t.msgNickName),/*@__PURE__*/e(u).createElement("div",null,t.msgContent),/*@__PURE__*/e(u).createElement("div",null,t.articleTitle),/*@__PURE__*/e(u).createElement("div",null,G(t.createDate)," / ",G(t.modifyDate)))),/*@__PURE__*/e(u).createElement("div",{className:"bottom"},/*@__PURE__*/e(u).createElement("div",{className:"btn-group"},/*@__PURE__*/e(u).createElement("div",{onClick:J.bind(v,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},/*@__PURE__*/e(u).createElement("i",{className:"fas fa-eye"})),/*@__PURE__*/e(u).createElement("div",{onClick:J.bind(v,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},/*@__PURE__*/e(u).createElement("i",{className:"fas fa-pencil"})),/*@__PURE__*/e(u).createElement("div",{onClick:J.bind(v,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},/*@__PURE__*/e(u).createElement("i",{className:"fas fa-trash-alt"}))))):/*@__PURE__*/e(u).createElement("div",{key:a,className:"msg-list-item"},/*@__PURE__*/e(u).createElement("div",null,t.msgNickName),/*@__PURE__*/e(u).createElement("div",null,t.msgContent),/*@__PURE__*/e(u).createElement("div",null,t.articleTitle),/*@__PURE__*/e(u).createElement("div",null,G(t.createDate)," / ",G(t.modifyDate)),/*@__PURE__*/e(u).createElement("div",{className:"btn-group"},/*@__PURE__*/e(u).createElement("div",{onClick:J.bind(v,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},/*@__PURE__*/e(u).createElement("i",{className:"fas fa-eye"})),/*@__PURE__*/e(u).createElement("div",{onClick:J.bind(v,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},/*@__PURE__*/e(u).createElement("i",{className:"fas fa-pencil"})),/*@__PURE__*/e(u).createElement("div",{onClick:J.bind(v,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},/*@__PURE__*/e(u).createElement("i",{className:"fas fa-trash-alt"}))))})),/*@__PURE__*/e(u).createElement("div",{className:"msg-list-footer"},"總留言數 ",P.length," 則"),/*@__PURE__*/e(u).createElement(N.Pagination,R)),/*@__PURE__*/e(u).createElement(N.ActionModal,{acionModalTitle:"".concat({DELETE:"刪除",READ:"檢視",EDIT:"編輯"}[M],"留言"),toggleModalStatus:L,confirmEvent:W.bind(v,M,"confirm"),cancelEvent:I?void 0:W.bind(v,M,"cancel")},/*@__PURE__*/e(u).createElement("div",{className:"top"},/*@__PURE__*/e(u).createElement(N.CustomInput,{label:"留言者",bindVal:S.msgNickName,type:"text",disabled:!0,className:S.msgNickName?"lock":""}),/*@__PURE__*/e(u).createElement("div",{className:"text-area-outer"},/*@__PURE__*/e(u).createElement(N.CustomTextArea,{label:"留言內容",bindVal:S.msgContent,type:"text",disabled:!0,className:S.msgContent?"lock":""}))),/*@__PURE__*/e(u).createElement("div",{className:"bottom"},/*@__PURE__*/e(u).createElement("div",{className:"title"},"回覆留言"),/*@__PURE__*/e(u).createElement("div",{className:"res-msg-list-outer"},S.resContentList.length>0?/*@__PURE__*/e(u).createElement("div",{className:"res-msg-list"},S.resContentList.map(function(t,a){return /*@__PURE__*/e(u).createElement("div",{key:a,className:"res-msg-list-item-outer"},/*@__PURE__*/e(u).createElement("div",{className:"row g-0"},/*@__PURE__*/e(u).createElement("div",{className:I?"col-sm-12":"col-sm-11"},/*@__PURE__*/e(u).createElement("div",{className:"res-msg-list-item"},/*@__PURE__*/e(u).createElement("div",{className:"res-msg-title"}," ",/*@__PURE__*/e(u).createElement("div",null,t.resMsgNickName),/*@__PURE__*/e(u).createElement("div",{className:"right-group"},/*@__PURE__*/e(u).createElement("div",null,G(t.createDate)))),/*@__PURE__*/e(u).createElement("div",null,t.resMsgContent))),I?null:/*@__PURE__*/e(u).createElement("div",{className:"col-sm-1"},/*@__PURE__*/e(u).createElement("div",{onClick:V.bind(v,t.resMsgID),className:"delete-msg-btn"},/*@__PURE__*/e(u).createElement("i",{className:"fas fa-trash-alt"})))))})):/*@__PURE__*/e(u).createElement("div",{className:"no-data"},"-- 無回覆內容 --")))),/*@__PURE__*/e(u).createElement(N.ActionModal,{toggleModalStatus:T,confirmEvent:W.bind(v,M,"confirm"),cancelEvent:W.bind(v,M,"cancel")},/*@__PURE__*/e(u).createElement("div",{className:"action-modal-body"},/*@__PURE__*/e(u).createElement("div",{className:"delete-context"},"確定要刪除 ",S.msgNickName," 此人的留言嗎？"))),/*@__PURE__*/e(u).createElement(N.Loading,{loadingStatus:A}))}}),a.register("e4nhi",function(e,n){t(e.exports,"default",function(){return c});var s=a("kfDXm"),i=a("186nW"),r=a("ksxDn"),l=/*#__PURE__*/function(){function e(){(0,s._)(this,e)}return(0,i._)(e,null,[{key:"createParts",value:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=(0,r._)(t,4),s=n[0],i=n[1],l=n[2],c=n[3];this.setting.totalLength=s.length,this.setting.partPage=l,this.setting.pageTotal=Math.ceil(this.setting.totalLength/this.setting.partPage),this.setting.pageSize=c,i=void 0===i?1:i,this.setting.currentPage=i,this.setting.hasPrev=this.setting.currentPage>1,this.setting.hasNext=this.setting.currentPage<this.setting.totalLength,this.setting.currentPage===this.setting.pageTotal&&(this.setting.hasNext=!1),this.setting.currentPage>this.setting.pageTotal&&(this.setting.currentPage=this.setting.pageTotal);var m=this.setting.currentPage*this.setting.partPage-this.setting.partPage+1,o=this.setting.currentPage*this.setting.partPage,u=s.map(function(e,t){return t+1>=m&&t+1<=o&&e}).filter(function(e){return!1!==e});return{pageObj:this.setting,renderItem:u}}}]),e}();l.setting={totalLength:0,partPage:0,pageTotal:0,currentPage:1,hasPrev:!1,hasNext:!0,pageSize:0};var c=l})}();