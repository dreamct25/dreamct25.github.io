function e(e){return e&&e.__esModule?e.default:e}function t(e,t,a,n){Object.defineProperty(e,t,{get:a,set:n,enumerable:!0,configurable:!0})}var a=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire35b1;a.register("5uSfZ",(function(n,s){var l;l=n.exports,Object.defineProperty(l,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",(function(){return u}),(function(e){return u=e}));var i=a("fcWWv"),r=a("kVWnA"),c=a("e0rqH"),m=a("stS02"),o=a("g5eIn"),d=a("7gcRj"),g=a("3Qkmj");var u=()=>{const{$:t,Fetch:a,getReducer:n,rwdStatus:s,changeWebTitle:l}=(0,c.useContext)(m.NewContext),{authInfo:u}=n((e=>(0,i.default)({},e.AdminLoginReducer))),[{msgData:N,renderMsgData:E,toggleModalStatus:v,toggleDeleteModalStatus:f,currentAction:p,valGroups:D,useDisabled:h,paginationObj:b},k]=(0,c.useState)({msgData:[],renderMsgData:[],toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},currentAction:"",useDisabled:!1,paginationObj:{}}),[C,y]=(0,c.useState)(!1),P={hasPrev:b.hasPrev,hasNext:b.hasNext,currentPage:b.currentPage,pageTotal:b.pageTotal,pageSize:b.pageSize,partPage:b.partPage,postNext:e=>{const{pages:t,partPage:a,pageSize:n}=e,{pageObj:s,renderItem:l}=o.default.createParts(N,t,a,n);k((e=>(0,r.default)((0,i.default)({},e),{renderMsgData:l,paginationObj:s})))}},L=e=>{const[t]=e.split(" ");return t},M=async()=>{y(!0),await a.get("/back_view_all",{token:u.token}).then((({data:e})=>{a.get("/back_msg_l_all",{token:u.token}).then((a=>{const n=t.maps(a.data,(a=>{const n=t.filter(e,(({uuid:e})=>e===a.articleID));return n.length>0?(0,r.default)((0,i.default)({},a),{articleTitle:n[0].articleTitle}):a})),{pageObj:s,renderItem:l}=o.default.createParts(n,1,10,10);k((e=>(0,r.default)((0,i.default)({},e),{msgData:n,renderMsgData:l,paginationObj:s}))),y(!1)})).catch((()=>alert("error")))})).catch((()=>alert("error")))},T=(e,t)=>{k("DELETE"===e?a=>(0,r.default)((0,i.default)({},a),{currentAction:e,valGroups:t,toggleDeleteModalStatus:!0}):a=>(0,r.default)((0,i.default)({},a),{currentAction:e,valGroups:t,toggleModalStatus:!0,useDisabled:"READ"===e}))},S=e=>{const a=JSON.parse(JSON.stringify(D)),n=t.findIndexOfObj(a.resContentList,(({resMsgID:t})=>t===e));a.resContentList=a.resContentList.remove(n),k((e=>(0,r.default)((0,i.default)({},e),{valGroups:a})))},I=(e,n)=>{let s=!1;(0,{[e]:async()=>{if("confirm"===n&&"READ"!==e){const e=t.formatDateTime({formatDate:new Date,formatType:"yyyy-MM-dd HH:mm:ss"}),n=JSON.parse(JSON.stringify(D));n.modifyDate=e,y(!0),await a.post("/update_msg_l",{token:u.token,data:n}),s=!0,y(!1)}},DELETE:async()=>{if("confirm"===n){const{mud:e}=D;y(!0),await a.post("/delete_msg_l",{token:u.token,data:{mud:e}}),M(),s=!0,y(!1)}}}[e])().finally((()=>{k((e=>(0,r.default)((0,i.default)({},e),{toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},useDisabled:!1}))),s&&M()}))};return(0,c.useEffect)((()=>{u.token&&M()}),[u]),e(c).createElement(g.Container,null,l("後台留言管理"),e(c).createElement("div",{className:"msg-layout"},s?null:e(c).createElement("div",{className:"msg-list-header"},["留言者","留言內容","留言文章","留言 / 修改日期","操作項"].map(((t,a)=>e(c).createElement("div",{key:a},t)))),e(c).createElement("div",{className:"msg-list"},0===E.length?e(c).createElement("div",{className:"no-data"},"-- 無留言 --"):E.map(((t,a)=>s?e(c).createElement("div",{key:a,className:"msg-list-item"},e(c).createElement("div",{className:"top"},e(c).createElement("div",{className:"left"},e(c).createElement("div",null,"留言者"),e(c).createElement("div",null,"留言內容"),e(c).createElement("div",null,"留言文章"),e(c).createElement("div",null,"留言 / 修改日期")),e(c).createElement("div",{className:"right"},e(c).createElement("div",null,t.msgNickName),e(c).createElement("div",null,t.msgContent),e(c).createElement("div",null,t.articleTitle),e(c).createElement("div",null,L(t.createDate)," / ",L(t.modifyDate)))),e(c).createElement("div",{className:"bottom"},e(c).createElement("div",{className:"btn-group"},e(c).createElement("div",{onClick:T.bind(void 0,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},e(c).createElement("i",{className:"fas fa-eye"})),e(c).createElement("div",{onClick:T.bind(void 0,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},e(c).createElement("i",{className:"fas fa-pencil"})),e(c).createElement("div",{onClick:T.bind(void 0,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},e(c).createElement("i",{className:"fas fa-trash-alt"}))))):e(c).createElement("div",{key:a,className:"msg-list-item"},e(c).createElement("div",null,t.msgNickName),e(c).createElement("div",null,t.msgContent),e(c).createElement("div",null,t.articleTitle),e(c).createElement("div",null,L(t.createDate)," / ",L(t.modifyDate)),e(c).createElement("div",{className:"btn-group"},e(c).createElement("div",{onClick:T.bind(void 0,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},e(c).createElement("i",{className:"fas fa-eye"})),e(c).createElement("div",{onClick:T.bind(void 0,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},e(c).createElement("i",{className:"fas fa-pencil"})),e(c).createElement("div",{onClick:T.bind(void 0,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},e(c).createElement("i",{className:"fas fa-trash-alt"}))))))),e(c).createElement("div",{className:"msg-list-footer"},"總留言數 ",N.length," 則"),e(c).createElement(d.Pagination,P)),e(c).createElement(d.ActionModal,{acionModalTitle:`${{DELETE:"刪除",READ:"檢視",EDIT:"編輯"}[p]}留言`,toggleModalStatus:v,confirmEvent:I.bind(void 0,p,"confirm"),cancelEvent:h?void 0:I.bind(void 0,p,"cancel")},e(c).createElement("div",{className:"top"},e(c).createElement(d.CustomInput,{label:"留言者",bindVal:D.msgNickName,type:"text",disabled:!0,className:D.msgNickName?"lock":""}),e(c).createElement("div",{className:"text-area-outer"},e(c).createElement(d.CustomTextArea,{label:"留言內容",bindVal:D.msgContent,type:"text",disabled:!0,className:D.msgContent?"lock":""}))),e(c).createElement("div",{className:"bottom"},e(c).createElement("div",{className:"title"},"回覆留言"),e(c).createElement("div",{className:"res-msg-list-outer"},D.resContentList.length>0?e(c).createElement("div",{className:"res-msg-list"},D.resContentList.map(((t,a)=>e(c).createElement("div",{key:a,className:"res-msg-list-item-outer"},e(c).createElement("div",{className:"row g-0"},e(c).createElement("div",{className:h?"col-sm-12":"col-sm-11"},e(c).createElement("div",{className:"res-msg-list-item"},e(c).createElement("div",{className:"res-msg-title"}," ",e(c).createElement("div",null,t.resMsgNickName),e(c).createElement("div",{className:"right-group"},e(c).createElement("div",null,L(t.createDate)))),e(c).createElement("div",null,t.resMsgContent))),h?null:e(c).createElement("div",{className:"col-sm-1"},e(c).createElement("div",{onClick:S.bind(void 0,t.resMsgID),className:"delete-msg-btn"},e(c).createElement("i",{className:"fas fa-trash-alt"})))))))):e(c).createElement("div",{className:"no-data"},"-- 無回覆內容 --")))),e(c).createElement(d.ActionModal,{toggleModalStatus:f,confirmEvent:I.bind(void 0,p,"confirm"),cancelEvent:I.bind(void 0,p,"cancel")},e(c).createElement("div",{className:"action-modal-body"},e(c).createElement("div",{className:"delete-context"},"確定要刪除 ",D.msgNickName," 此人的留言嗎？"))),e(c).createElement(d.Loading,{loadingStatus:C}))}})),a.register("g5eIn",(function(e,n){t(e.exports,"default",(function(){return i}));var s=a("G2HKY");class l{static createParts(...e){let[t,a,n,s]=e;this.setting.totalLength=t.length,this.setting.partPage=n,this.setting.pageTotal=Math.ceil(this.setting.totalLength/this.setting.partPage),this.setting.pageSize=s,a=void 0===a?1:a,this.setting.currentPage=a,this.setting.hasPrev=this.setting.currentPage>1,this.setting.hasNext=this.setting.currentPage<this.setting.totalLength,this.setting.currentPage===this.setting.pageTotal&&(this.setting.hasNext=!1),this.setting.currentPage>this.setting.pageTotal&&(this.setting.currentPage=this.setting.pageTotal);const l=this.setting.currentPage*this.setting.partPage-this.setting.partPage+1,i=this.setting.currentPage*this.setting.partPage,r=t.map(((e,t)=>t+1>=l&&t+1<=i&&e)).filter((e=>!1!==e));return{pageObj:this.setting,renderItem:r}}}(0,s.default)(l,"setting",{totalLength:0,partPage:0,pageTotal:0,currentPage:1,hasPrev:!1,hasNext:!0,pageSize:0});var i=l}));