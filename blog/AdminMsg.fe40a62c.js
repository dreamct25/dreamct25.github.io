!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,a,n){Object.defineProperty(e,t,{get:a,set:n,enumerable:!0,configurable:!0})}var a=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire35b1;a.register("caVT7",(function(n,s){var l;l=n.exports,Object.defineProperty(l,"__esModule",{value:!0,configurable:!0}),t(n.exports,"default",(function(){return h}),(function(e){return h=e}));var i=a("8CHzG"),r=a("fto12"),c=a("75JRK"),m=a("e4tPT"),o=a("4Fae7"),u=a("bW9HB"),d=a("diPDO"),g=a("cYcEi"),f=a("5OXzf"),N=a("e4nhi"),E=a("dR8pc"),v=a("7fGfG"),p=void 0,h=function(){var t,a=(0,d.useContext)(f.NewContext),n=a.$,s=a.Fetch,l=a.getReducer,h=a.rwdStatus,D=a.changeWebTitle,b=(0,g.useNavigate)(),C=l((function(e){return(0,c.default)({},e.AdminLoginReducer)})).authInfo,k=(0,o.default)((0,d.useState)({msgData:[],renderMsgData:[],toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},currentAction:"",useDisabled:!1,paginationObj:{}}),2),P=k[0],y=P.msgData,L=P.renderMsgData,T=P.toggleModalStatus,M=P.toggleDeleteModalStatus,S=P.currentAction,I=P.valGroups,_=P.useDisabled,x=P.paginationObj,O=k[1],w=(0,o.default)((0,d.useState)(!1),2),A=w[0],j=w[1],R={hasPrev:x.hasPrev,hasNext:x.hasNext,currentPage:x.currentPage,pageTotal:x.pageTotal,pageSize:x.pageSize,partPage:x.partPage,postNext:function(e){var t=e.pages,a=e.partPage,n=e.pageSize,s=N.default.createParts(y,t,a,n),l=s.pageObj,i=s.renderItem;O((function(e){return(0,m.default)((0,c.default)({},e),{renderMsgData:i,paginationObj:l})}))}},G=function(e){return(0,o.default)(e.split(" "),1)[0]},z=(t=(0,i.default)((function(){return(0,u.__generator)(this,(function(e){switch(e.label){case 0:return j(!0),[4,s.get("/back_view_all",{token:C.token}).then((function(e){var t=e.data;s.get("/back_msg_l_all",{token:C.token}).then((function(e){var a=n.maps(e.data,(function(e){var a=n.filter(t,(function(t){return t.uuid===e.articleID}));return a.length>0?(0,m.default)((0,c.default)({},e),{articleTitle:a[0].articleTitle}):e})),s=N.default.createParts(a,1,10,10),l=s.pageObj,i=s.renderItem;O((function(e){return(0,m.default)((0,c.default)({},e),{msgData:a,renderMsgData:i,paginationObj:l})})),j(!1)})).catch((function(){return alert("error")}))})).catch((function(){return alert("error")}))];case 1:return e.sent(),[2]}}))})),function(){return t.apply(this,arguments)}),H=function(e,t){O("DELETE"===e?function(a){return(0,m.default)((0,c.default)({},a),{currentAction:e,valGroups:t,toggleDeleteModalStatus:!0})}:function(a){return(0,m.default)((0,c.default)({},a),{currentAction:e,valGroups:t,toggleModalStatus:!0,useDisabled:"READ"===e})})},J=function(e){var t=JSON.parse(JSON.stringify(I)),a=n.findIndexOfObj(t.resContentList,(function(t){return t.resMsgID===e}));t.resContentList=t.resContentList.remove(a),O((function(e){return(0,m.default)((0,c.default)({},e),{valGroups:t})}))},F=function(e,t){var a,l=!1;(0,(a={},(0,r.default)(a,e,(0,i.default)((function(){var a,i;return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return"confirm"!==t||"READ"===e?[3,2]:(a=n.formatDateTime({formatDate:new Date,formatType:"yyyy-MM-dd HH:mm:ss"}),(i=JSON.parse(JSON.stringify(I))).modifyDate=a,j(!0),[4,s.post("/update_msg_l",{token:C.token,data:i})]);case 1:r.sent(),l=!0,j(!1),r.label=2;case 2:return[2]}}))}))),(0,r.default)(a,"DELETE",(0,i.default)((function(){var e;return(0,u.__generator)(this,(function(a){switch(a.label){case 0:return"confirm"!==t?[3,2]:(e=I.mud,j(!0),[4,s.post("/delete_msg_l",{token:C.token,data:{mud:e}})]);case 1:a.sent(),z(),l=!0,j(!1),a.label=2;case 2:return[2]}}))}))),a)[e])().finally((function(){O((function(e){return(0,m.default)((0,c.default)({},e),{toggleModalStatus:!1,toggleDeleteModalStatus:!1,valGroups:{mud:"",articleID:"",msgNickName:"",msgContent:"",resContentList:[],createDate:""},useDisabled:!1})})),l&&z()}))};return(0,d.useEffect)((function(){(null==C?void 0:C.token)?z():b({pathname:"/admin/login"})}),[C]),e(d).createElement(v.Container,null,D("後台留言管理"),e(d).createElement("div",{className:"msg-layout"},h?null:e(d).createElement("div",{className:"msg-list-header"},["留言者","留言內容","留言文章","留言 / 修改日期","操作項"].map((function(t,a){return e(d).createElement("div",{key:a},t)}))),e(d).createElement("div",{className:"msg-list"},0===L.length?e(d).createElement("div",{className:"no-data"},"-- 無留言 --"):L.map((function(t,a){return h?e(d).createElement("div",{key:a,className:"msg-list-item"},e(d).createElement("div",{className:"top"},e(d).createElement("div",{className:"left"},e(d).createElement("div",null,"留言者"),e(d).createElement("div",null,"留言內容"),e(d).createElement("div",null,"留言文章"),e(d).createElement("div",null,"留言 / 修改日期")),e(d).createElement("div",{className:"right"},e(d).createElement("div",null,t.msgNickName),e(d).createElement("div",null,t.msgContent),e(d).createElement("div",null,t.articleTitle),e(d).createElement("div",null,G(t.createDate)," / ",G(t.modifyDate)))),e(d).createElement("div",{className:"bottom"},e(d).createElement("div",{className:"btn-group"},e(d).createElement("div",{onClick:H.bind(p,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},e(d).createElement("i",{className:"fas fa-eye"})),e(d).createElement("div",{onClick:H.bind(p,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},e(d).createElement("i",{className:"fas fa-pencil"})),e(d).createElement("div",{onClick:H.bind(p,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},e(d).createElement("i",{className:"fas fa-trash-alt"}))))):e(d).createElement("div",{key:a,className:"msg-list-item"},e(d).createElement("div",null,t.msgNickName),e(d).createElement("div",null,t.msgContent),e(d).createElement("div",null,t.articleTitle),e(d).createElement("div",null,G(t.createDate)," / ",G(t.modifyDate)),e(d).createElement("div",{className:"btn-group"},e(d).createElement("div",{onClick:H.bind(p,"READ",{mud:"",msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:"",resContentList:t.resContentList,createDate:""}),className:"preview"},e(d).createElement("i",{className:"fas fa-eye"})),e(d).createElement("div",{onClick:H.bind(p,"EDIT",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:t.msgContent,articleID:t.articleID,resContentList:t.resContentList,createDate:t.createDate}),className:"edit-btn"},e(d).createElement("i",{className:"fas fa-pencil"})),e(d).createElement("div",{onClick:H.bind(p,"DELETE",{mud:t.uuid,msgNickName:t.msgNickName,msgContent:"",articleID:"",resContentList:[],createDate:""}),className:"delete-btn"},e(d).createElement("i",{className:"fas fa-trash-alt"}))))}))),e(d).createElement("div",{className:"msg-list-footer"},"總留言數 ",y.length," 則"),e(d).createElement(E.Pagination,R)),e(d).createElement(E.ActionModal,{acionModalTitle:"".concat({DELETE:"刪除",READ:"檢視",EDIT:"編輯"}[S],"留言"),toggleModalStatus:T,confirmEvent:F.bind(p,S,"confirm"),cancelEvent:_?void 0:F.bind(p,S,"cancel")},e(d).createElement("div",{className:"top"},e(d).createElement(E.CustomInput,{label:"留言者",bindVal:I.msgNickName,type:"text",disabled:!0,className:I.msgNickName?"lock":""}),e(d).createElement("div",{className:"text-area-outer"},e(d).createElement(E.CustomTextArea,{label:"留言內容",bindVal:I.msgContent,type:"text",disabled:!0,className:I.msgContent?"lock":""}))),e(d).createElement("div",{className:"bottom"},e(d).createElement("div",{className:"title"},"回覆留言"),e(d).createElement("div",{className:"res-msg-list-outer"},I.resContentList.length>0?e(d).createElement("div",{className:"res-msg-list"},I.resContentList.map((function(t,a){return e(d).createElement("div",{key:a,className:"res-msg-list-item-outer"},e(d).createElement("div",{className:"row g-0"},e(d).createElement("div",{className:_?"col-sm-12":"col-sm-11"},e(d).createElement("div",{className:"res-msg-list-item"},e(d).createElement("div",{className:"res-msg-title"}," ",e(d).createElement("div",null,t.resMsgNickName),e(d).createElement("div",{className:"right-group"},e(d).createElement("div",null,G(t.createDate)))),e(d).createElement("div",null,t.resMsgContent))),_?null:e(d).createElement("div",{className:"col-sm-1"},e(d).createElement("div",{onClick:J.bind(p,t.resMsgID),className:"delete-msg-btn"},e(d).createElement("i",{className:"fas fa-trash-alt"})))))}))):e(d).createElement("div",{className:"no-data"},"-- 無回覆內容 --")))),e(d).createElement(E.ActionModal,{toggleModalStatus:M,confirmEvent:F.bind(p,S,"confirm"),cancelEvent:F.bind(p,S,"cancel")},e(d).createElement("div",{className:"action-modal-body"},e(d).createElement("div",{className:"delete-context"},"確定要刪除 ",I.msgNickName," 此人的留言嗎？"))),e(d).createElement(E.Loading,{loadingStatus:A}))}})),a.register("e4nhi",(function(e,n){t(e.exports,"default",(function(){return m}));var s=a("655lB"),l=a("5UHXD"),i=a("fto12"),r=a("4Fae7"),c=function(){"use strict";function e(){(0,s.default)(this,e)}return(0,l.default)(e,null,[{key:"createParts",value:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=(0,r.default)(t,4),s=n[0],l=n[1],i=n[2],c=n[3];this.setting.totalLength=s.length,this.setting.partPage=i,this.setting.pageTotal=Math.ceil(this.setting.totalLength/this.setting.partPage),this.setting.pageSize=c,l=void 0===l?1:l,this.setting.currentPage=l,this.setting.hasPrev=this.setting.currentPage>1,this.setting.hasNext=this.setting.currentPage<this.setting.totalLength,this.setting.currentPage===this.setting.pageTotal&&(this.setting.hasNext=!1),this.setting.currentPage>this.setting.pageTotal&&(this.setting.currentPage=this.setting.pageTotal);var m=this.setting.currentPage*this.setting.partPage-this.setting.partPage+1,o=this.setting.currentPage*this.setting.partPage,u=s,d=u.map((function(e,t){return t+1>=m&&t+1<=o&&e})).filter((function(e){return!1!==e}));return{pageObj:this.setting,renderItem:d}}}]),e}();(0,i.default)(c,"setting",{totalLength:0,partPage:0,pageTotal:0,currentPage:1,hasPrev:!1,hasNext:!0,pageSize:0});var m=c}))}();