// © CopyRight 2021-08 - 2023-06 Alex Chen. Library language - Javascript ver 1.5.9 min
// Work Environment Javascript ES6 or latest、ESlint 8.42.0

/* eslint-disable no-return-assign */
/* eslint-disable no-prototype-builtins */
/* eslint-disable promise/param-names */
/* eslint-disable prefer-promise-reject-errors */
/* eslint-disable no-async-promise-executor */
"use strict";const $=(el=>{let $=e=>{let t=el.call(el,e)||e;return t.texts=e=>{if(!e)return t.textContent;t.textContent=e},t.html=e=>{if(!e)return t.innerHTML;t.innerHTML=e},t.addClass=e=>(t.classList.add(e),t),t.removeClass=e=>(t.classList.remove(e),t),t.toggleClass=e=>t.classList.toggle(e),t.on=(e,r)=>{t[["on",e].join("")]=()=>r.call(r,t)},t.listener=(e,r)=>t.addEventListener(e,r),t.removeListener=(e,r)=>t.removeEventListener(e,r),t.val=e=>{if(!e)return t.value;t.value=e},t.attr=(e,r)=>r?t.setAttribute(e,r):t.getAttribute(e),t.props=(e,r)=>r?t[e]=r:t[e],t.sibling=e=>t[e],t.child=e=>t.children[e],t.childFirst=()=>t.firstElementChild,t.childLast=()=>t.lastElementChild,t.parent=()=>t.parentNode,t.appendDom=e=>t.append(e),t.removeDom=()=>t.remove(),t.removeChildDom=()=>t.replaceChildren(),t.appendDomText=e=>t.appendChild(e),t.easyAppendDom=(e,r)=>t.insertAdjacentHTML("afterDom"!==e?"afterbegin":"beforeend",r),t.styles=(e,r,o)=>{if(!$.includes(["set","remove"],e)){$.console("error","First parameter method must use string and keyword is 'set' or 'remove'.");return}return"set"===e?t.style.setProperty(r,o):t.style.removeProperty(r),t},t.getDomStyles=e=>{let r={};if("object"!=typeof e){$.console("error","Parameter must use array.");return}if(0!==e.length)return $.each(e,e=>r[e]=getComputedStyle(t).getPropertyValue(e)),r;$.console("error","Parameter must use array,and css property must in array with string.")},t.getDomPos=()=>({x:t.props("offsetLeft"),y:t.props("offsetTop")-window.scrollY,top:t.props("offsetTop")-window.scrollY,left:t.props("offsetLeft"),right:t.props("offsetLeft")+t.props("offsetWidth"),bottom:t.props("offsetTop")+t.props("offsetHeight")-window.scrollY,width:t.props("offsetWidth"),height:t.props("offsetHeight")}),t.scrollToTop=(e={scrollTop:0,duration:0})=>{let r,[o,s]=Object.keys(e),a=t[o],n=e[o]-a,i=+new Date,l=(e={currentTime:0,startVal:0,changeVal:0,animateDuration:0})=>{let{currentTime:t,startVal:r,changeVal:o,animateDuration:s}=e,a=t;return(a/=s/2)<1?o/2*a*a+r:-o/2*((a-=1)*(a-2)-1)+r};(r=()=>{let u=+new Date-i;t.scrollTop=Number(l({currentTime:u,startVal:a,changeVal:n,animateDuration:e[s]})),u<e[s]?requestAnimationFrame(r):t.scrollTop=e[o]})()},t.useWillMount=e=>{"object"==typeof t&&$.typeOf(t,"HTMLDocument")?t.listener("readystatechange",({target:t})=>"interactive"===t.readyState&&e.call(e,t)):$.console("error","UseWillMount hook just use when selector document.")},t.useMounted=e=>{"object"==typeof t&&$.typeOf(t,"HTMLDocument")?t.listener("readystatechange",({target:t})=>"complete"===t.readyState&&e.call(e,t)):$.console("error","UseMounted Hook just use when selector document.")},t};$.each=(e,t)=>e.forEach((e,r)=>t.call(t,e,r)),$.maps=(e,t)=>e.map((e,r)=>t.call(t,e,r)),$.filter=(e,t)=>e.filter(e=>t.call(t,e)),$.find=(e,t)=>e.find(e=>t.call(t,e)),$.sort=(e,t)=>e.sort((e,r)=>t.call(t,e,r)),$.indexOf=(e,t)=>e.indexOf(t),$.includes=(e,t)=>e.includes(t),$.findIndexOfObj=(e,t)=>e.findIndex(e=>t.call(t,e)),$.findObjProperty=(e,t)=>e.hasOwnProperty(t),$.sum=(e,t,r)=>r?e.reduce((e,r)=>t.call(t,e,r),r):e.reduce((e,r)=>t.call(t,e,r)),$.mergeArray=(e,t,r)=>r?e.concat(t):r.call(r,e.concat(t)),$.typeOf=(e,t)=>t?e.constructor.name===t:e.constructor.name,$.console=(e,...t)=>console[e](...t),$.localData=(e,t,r)=>"get"===e?$.convert(localStorage.getItem(t),"json")||[]:localStorage.setItem(t,$.convert(r,"stringify")),$.getNumberOfDecimal=(e,t)=>parseInt(e.toFixed(t)),$.createCustomEvent=(e,t)=>t?new CustomEvent(e,{detail:t}):new CustomEvent(e),$.registerCustomEvent=(e,t)=>window.addEventListener(e,t),$.useCustomEvent=e=>window.dispatchEvent(e),$.removeCustomEvent=(e,t)=>window.removeEventListener(e,t),$.createPromise=e=>new Promise((t,r)=>e.call(e,t,r)),$.createPromiseAll=(...e)=>Promise.all(e),$.createDomText=e=>document.createTextNode(e),$.objDetails=(e,t)=>t&&$.includes(["keys","values","entries"],t)?Object[t](e):$.console("error","please enter secode prameter 'keys' or 'values' or 'entries' in type string"),$.isObjectTheSame=(e,t)=>$.convert(e,"stringify")===$.convert(t,"stringify"),$.useBase64=(e,t)=>"encode"===e?btoa(t):atob(t),$.useSHA=async(e,t)=>{let r=await window.crypto.subtle.digest(e,new TextEncoder().encode(t));return Array.from(new Uint8Array(r)).map(e=>e.toString(16).padStart(2,"0")).join("")},$.useUnicode=(str,method)=>"encode"===method?$.createArray({type:"fake",item:{random:str.length}},e=>{let t=str.charCodeAt(e),r=t.toString(16);return t<15?`\\u000${r.toUpperCase()}`:t<255?`\\u00${r.toUpperCase()}`:t<4095?`\\u0${r.toUpperCase()}`:`\\u${r.toUpperCase()}`}).join(""):eval(`'${str}'`),$.createArray=({type:e,item:t},r)=>{if("fake"===e){if("random"in t&&$.typeOf(t.random,"Number")&&void 0!==r&&$.typeOf(r,"Function"))return Array.from({length:t.random},(e,t)=>r.call(r,t));$.console("error","item property must have random in object and radom type must be number,with call back function in secode parameters.")}else if("new"===e&&!("random"in t))return Array.from(t)},$.convert=(e,t)=>{if(e&&t&&$.includes(["string","number","float","boolean","json","stringify"],t)){if($.typeOf(e,"Object")&&$.includes(["string","number","float","boolean"],t)){$.console("error",`Convert value can't be object when use convert type ${t}.`);return}}else{$.console("error","Please enter first parameters value who want to convert and seconde paramters value is convert type 'string' or 'number' or 'float' or 'boolean' or 'json' or 'stringify'.");return}let r={string:String(e),number:parseInt(e),float:parseFloat(e),boolean:Boolean(e),json:"json"===t&&JSON.parse(e),stringify:"stringify"===t&&JSON.stringify(e)};return r[t]},$.createDom=(e,t)=>{let r=document.createElement(e),o=Object.entries(t);return $.each(o,e=>{let[t,o]=e;if($.typeOf(o,"Object")){let[s,a]=e,[[n,i]]=Object.entries(a);r[s][n]=i}else r[t]=$.typeOf(o,"String")?o.trim():o}),r},$.currencyTranser=(e,t,r)=>{if($.typeOf(e,"Number")){let o=r?{style:"currency",currency:t}:{};return new Intl.NumberFormat(t||"TWN",o).format(e)}$.console("error","First argument formatNumber type must use number.")},$.formatDateTime=(e={formatDate:"",formatType:""})=>{if(!($.findObjProperty(e,"formatDate")||$.findObjProperty(e,"formatType"))){$.console("error","Please enter an object and use formatType property in the object.");return}if($.findObjProperty(e,"customWeekItem")){if("Array"!==$.typeOf(e.customWeekItem)){$.console("error","customWeekItem property Must use array.");return}if(e.customWeekItem.length<=6||e.customWeekItem.length>7){$.console("error","customWeekItem property must put seven days name of week in array.");return}e.customWeekItem=[e.customWeekItem[e.customWeekItem.length-1],...e.customWeekItem].removeLast()}let t=($.findObjProperty(e,"localCountryTime")?e.localCountryTime:8)*36e5,r=new Date(($.typeOf(e.formatDate,"Number")?e.formatDate:+new Date(e.formatDate))+t).toJSON(),o=r.replace(/T/g,"-").replace(/:/g,"-").replace(/\./g,"-").replace(/Z/g,"").split("-"),[s,a,n,i,l,u,c]=o,p=e?.toROCYear?(parseInt(s)-1911).toString():s;if($.findObjProperty(e,"toDateFullNumber"))return $.convert(o.join(""),"number");if(e.formatType.match("tt")){let d=$.convert(i,"number")>11?"PM":"AM",m=$.convert(i,"number")-12<10?`0${$.convert(i,"number")-12}`:$.convert($.convert(i,"number")-12,"string");return e.formatType.replace(/yyyy/g,p).replace(/MM/g,a).replace(/dd/g,n).replace(/HH/g,m).replace(/mm/g,l).replace(/ss/g,u).replace(/ms/g,c).replace(/tt/g,d)}return $.findObjProperty(e,"customWeekItem")?{fullDateTime:e.formatType.replace(/yyyy/g,p).replace(/MM/g,a).replace(/dd/g,n).replace(/HH/g,i).replace(/mm/g,l).replace(/ss/g,u).replace(/ms/g,c),getWeekName:e.customWeekItem[new Date(+new Date(e.formatDate)).getDay()]}:e.formatType.replace(/yyyy/g,p).replace(/MM/g,a).replace(/dd/g,n).replace(/HH/g,i).replace(/mm/g,l).replace(/ss/g,u).replace(/ms/g,c)};class FetchClass{static #a="";static #b={};static{this.fetchSetting=async(e,t)=>{let r={},{method:o,headers:s,contentType:a,useFormData:n,useXMLHttpRequest:i,returnType:l,data:u,routeParams:c,queryParams:p,timeout:d,beforePost:m,successFn:y,excuteDone:f,errorFn:h}=e;r.method=o,e.url=FetchClass.#a?`${FetchClass.#a}${e.url}`:e.url;let g=l||"json";if(o){if(!$.includes(["get","post","patch","put","delete"],o.toLocaleLowerCase())){$.console("error","Method value must use valid request method,like get、post ...");return}}else{$.console("error","Property name method is required in obejct parameters.");return}if(e.useFormData=!!n,c){let[b]=$.objDetails(c,"keys");e.url=`${e.url}/${c[b]}`}if(p){let v=$.maps(Object.entries(p),([e,t])=>`${e}=${t}`).join("&");e.url=`${e.url}?${v}`}if(($.objDetails(FetchClass.#b,"keys").length>0||s&&$.objDetails(s,"keys").length>0)&&(r.headers=$.objDetails(FetchClass.#b,"keys").length>0?FetchClass.#b:{"Content-Type":"application/json",...s}),u&&(n?r.body=this.convertFormData(u):(r.headers=$.objDetails(FetchClass.#b,"keys").length>0?FetchClass.#b:{"Content-Type":a||"application/json"},r.body=$.convert(u,"stringify"))),($.objDetails(FetchClass.#b,"keys").length>0||s)&&u&&(r.headers=$.objDetails(FetchClass.#b,"keys").length>0?FetchClass.#b:{...s},r.body=n?this.convertFormData(u):$.convert(u,"stringify")),!t&&!i){if(m&&m.call(m),!y){$.console("error","Function Name successFn is required in obejct parameters.");return}if(!h){$.console("error","Function Name errorFn is required in obejct parameters.");return}}if(i){if(y){$.console("error","successFn not necessary parameters.");return}if(h){$.console("error","errorFn not necessary parameters.");return}return this.XMLHttpRequest({url:e.url,method:r.method,headers:r.headers,data:r.body})}let j=new AbortController;d&&setTimeout(()=>j.abort(),d);let D=await fetch(e.url,d?{...r,signal:j.signal}:r);if(t)return new Promise(async(e,t)=>{if(D.status>=200&&D.status<400){let r=await D[g]();e({bodyUsed:D.bodyUsed,headers:D.headers,ok:D.ok,redirected:D.redirected,status:D.status,statusText:D.statusText,type:D.type,url:D.url,data:r})}else t({bodyUsed:D.bodyUsed,headers:D.headers,ok:D.ok,redirected:D.redirected,status:D.status,statusText:D.statusText,type:D.type,url:D.url})});try{if(D.status>=200&&D.status<400){let T=await D[g]();y.call(y,{bodyUsed:D.bodyUsed,headers:D.headers,ok:D.ok,redirected:D.redirected,status:D.status,statusText:D.statusText,type:D.type,url:D.url,data:T}),f&&f.call(f)}else throw Error(JSON.stringify({bodyUsed:D.bodyUsed,headers:D.headers,ok:D.ok,redirected:D.redirected,status:D.status,statusText:D.statusText,type:D.type,url:D.url}))}catch(w){h.call(h,JSON.parse(w.message))}},this.XMLHttpRequest=e=>{let t=new XMLHttpRequest;return t.open(e.method,e.url,!0),e?.headers&&$.each($.objDetails(e?.headers,"entries"),([e,r])=>t.setRequestHeader(e,r)),{xhrResponseResult(e){t.onreadystatechange=()=>{if(t.readyState===t.DONE&&t.status>=200&&t.status<=399)try{let r=JSON.parse(t.responseText);e.call(e,r)}catch(o){$.error("error",o)}t.status>=400&&$.error("error",t.statusText)}},xhrUploadProgress(e){t.upload.onprogress=t=>{if(t.lengthComputable){let r=100*t.loaded/t.total;e.call(e,r)}}},xhrRequestStart:()=>t.send(e?.data||void 0)}},this.convertFormData=e=>{let t=new FormData;return $.each($.objDetails(e,"entries"),([e,r])=>t.append("uploadFile"===e?"FileList":e,r)),t},this.createBase=({baseUrl:e,baseHeaders:t})=>{FetchClass.#a=e,FetchClass.#b=t}}}class FetchPromisClass extends FetchClass{static{this.get=async(e,t)=>await this.fetchSetting({method:"get",url:e,...t},!0),this.post=async(e,t)=>await this.fetchSetting({method:"post",url:e,...t},!0),this.patch=async(e,t)=>await this.fetchSetting({method:"patch",url:e,...t},!0),this.put=async(e,t)=>await this.fetchSetting({method:"put",url:e,...t},!0),this.delete=async(e,t)=>await this.fetchSetting({method:"delete",url:e,...t},!0)}}let fetchGroup=(e={method:"",url:"",headers:{},contentType:"",useFormData:!1,useXMLHttpRequest:!1,returnType:"",routeParams:{},queryParams:{},data:{},beforePost:void 0,successFn:void 0,excuteDone:void 0,errorFn:void 0})=>FetchClass.fetchSetting(e,!1);return fetchGroup.get=async(e,t={headers:{},returnType:"",useFormData:!1,useXMLHttpRequest:!1,routeParams:{},queryParams:{}})=>await FetchPromisClass.get(e,t),fetchGroup.post=async(e,t={headers:{},data:{},returnType:"",useFormData:!1,useXMLHttpRequest:!1,routeParams:{},queryParams:{}})=>await FetchPromisClass.post(e,t),fetchGroup.patch=async(e,t={headers:{},data:{},returnType:"",useFormData:!1,useXMLHttpRequest:!1,routeParams:{},queryParams:{}})=>await FetchPromisClass.patch(e,t),fetchGroup.put=async(e,t={headers:{},data:{},returnType:"",useFormData:!1,useXMLHttpRequest:!1,routeParams:{},queryParams:{}})=>await FetchPromisClass.put(e,t),fetchGroup.delete=async(e,t={headers:{},data:{},returnType:"",useFormData:!1,useXMLHttpRequest:!1,routeParams:{},queryParams:{}})=>await FetchPromisClass.delete(e,t),fetchGroup.createBase=(e={baseUrl:"",baseHeaders:{}})=>FetchClass.createBase(e),$.fetch=fetchGroup,$})(e=>"object"==typeof e?e:document.querySelectorAll(e).length>1?document.querySelectorAll(e):document.querySelector(e));JSON.deepCopy=e=>$.convert($.convert(e,"stringify"),"json"),Math.toFixedNum=(e={value:""|0,toFloatPos:0})=>{if(!e||!$.findObjProperty(e,"value")||!$.findObjProperty(e,"toFloatPos")){$.console("error","Please use object and with key value pair. ex: { value:100.1,toFloatPos:1 }");return}if(!$.typeOf(e.toFloatPos,"Number")){$.console("error","toFloatPos key must use number.");return}return $.typeOf(e.value,"String")?Number(parseFloat(e.value).toFixed(e.toFloatPos)):Number(e.value.toFixed(e.toFloatPos))},String.prototype.appendText=function(e){return this.toString()+e},String.prototype.appendDirection=function(e,t,r){return this["left"===e?"padStart":"padEnd"](t,r)},String.prototype.range=function(e,t){return this.toString().slice(e,t)},String.prototype.format=function(e,...t){if($.typeOf(e,"String")&&$.includes(e,"{")&&$.includes(e,"}")){if(e.split("{").join("").split("}").length-1===t.length){let r=e,o=$.maps(t,(e,t)=>({replaceKey:`{${t}}`,replaceValue:e})),s=$.maps(o,({replaceKey:e,replaceValue:t})=>r=r.replace(e,t)).range(o.length-1,o.length).join("");return s}$.console("error","Can't not find else aguments.")}else $.console("error","First paramter must use type string,if use string must like this ex：abc {0} efg {1}.")},String.toChartCode=e=>$.createArray({type:"fake",item:{random:e.length}},t=>e.charCodeAt(t)),Date.prototype.calculateDay=function(e){if(e&&"day"in e&&"method"in e){if("number"!=typeof e.day){$.console("error","day property must use type number.");return}if(!$.includes(["addDay","reduceDay"],e.method)){$.console("error","Please enter method type 'addDay' or 'reduceDay'.");return}}else{$.console("error","Please enter an object and use day and method property in the object.");return}return({addDay:new Date(+this+864e5*e.day),reduceDay:new Date(+this-864e5*e.day)})[e.method]},Date.prototype.getLocalTimeZone=function(){return Math.abs(this.getTimezoneOffset()/60)},Date.prototype.toOptionTimeZoneForISO=function(e){return e?new Date(+this+36e5*e).toISOString():$.console("error","Lost one parameter in function.")},Array.prototype.append=function(e){this.push(e)},Array.prototype.appendFirst=function(e){return this.unshift(e),this},Array.prototype.range=function(e,t){return this.slice(e,t)},Array.prototype.remove=function(e){return this.splice(e,1),this},Array.prototype.removeFirst=function(){return this.shift(),this},Array.prototype.removeLast=function(){return this.pop(),this},Map.prototype.append=function(e,t){this.set(e,t)},Map.prototype.getValue=function(e){return this.get(e)},Map.prototype.deleteKeyValue=function(e){return this.delete(e)},Map.prototype.removeAll=function(){this.clear()},Map.prototype.isKeyInMap=function(e){return this.has(e)},Map.prototype.toObject=function(){return Object.fromEntries(this)},Set.prototype.append=function(e){this.add(e)},Set.prototype.deleteValue=function(e){return this.delete(e)},Set.prototype.isValueInSet=function(e){return this.has(e)},Set.prototype.removeAll=function(){this.clear()},Set.prototype.toArray=function(){return[...this]},Object.prototype.toMap=function(e){return new Map(Object.entries(e))};