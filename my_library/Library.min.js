// © CopyRight 2021/08 - 2023/02 Alex Chen. Library language - javascript ver 1.5.6
// Work Environment Javascript ES6 or latest、ESlint 8.28.0

/* eslint-disable no-return-assign */
/* eslint-disable no-prototype-builtins */
/* eslint-disable promise/param-names */
/* eslint-disable prefer-promise-reject-errors */
/* eslint-disable no-async-promise-executor */
"use strict";const $=(e=>{let t=r=>{let o=e.call(e,r)||r;return o.texts=e=>e?o.textContent=e:o.textContent,o.html=e=>e?o.innerHTML=e:o.innerHTML,o.addClass=e=>(o.classList.add(e),o),o.removeClass=e=>(o.classList.remove(e),o),o.toggleClass=e=>o.classList.toggle(e),o.on=(e,t)=>{o[["on",e].join("")]=()=>t.call(t,o)},o.listener=(e,t)=>o.addEventListener(e,t),o.removeListener=(e,t)=>o.removeEventListener(e,t),o.val=e=>e?o.value=e:o.value,o.attr=(e,t)=>t?o.setAttribute(e,t):o.getAttribute(e),o.props=(e,t)=>t?o[e]=t:o[e],o.sibling=e=>o[e],o.child=e=>o.children[e],o.childFirst=()=>o.firstElementChild,o.childLast=()=>o.lastElementChild,o.parent=()=>o.parentNode,o.appendDom=e=>o.append(e),o.removeDom=()=>o.remove(),o.removeChildDom=()=>o.replaceChildren(),o.appendDomText=e=>o.appendChild(e),o.easyAppendDom=(e,t)=>o.insertAdjacentHTML("afterDom"!==e?"afterbegin":"beforeend",t),o.styles=(e,r,s)=>{if(!t.includes(["set","remove"],e)){t.console("error","First parameter method must use string and keyword is 'set' or 'remove'.");return}return"set"===e?o.style.setProperty(r,s):o.style.removeProperty(r),o},o.getDomStyles=e=>{let r={};if("object"!=typeof e){t.console("error","Parameter must use array.");return}if(0!==e.length)return t.each(e,e=>r[e]=getComputedStyle(o).getPropertyValue(e)),r;t.console("error","Parameter must use array,and css property must in array with string.")},o.getDomPos=()=>({x:o.props("offsetLeft"),y:o.props("offsetTop")-window.scrollY,top:o.props("offsetTop")-window.scrollY,left:o.props("offsetLeft"),right:o.props("offsetLeft")+o.props("offsetWidth"),bottom:o.props("offsetTop")+o.props("offsetHeight")-window.scrollY,width:o.props("offsetWidth"),height:o.props("offsetHeight")}),o.scrollToTop=(e={scrollTop:0,duration:0})=>{let t,[r,s]=Object.keys(e),n=o[r],a=e[r]-n,i=+new Date,l=(e={currentTime:0,startVal:0,changeVal:0,animateDuration:0})=>{let{currentTime:t,startVal:r,changeVal:o,animateDuration:s}=e,n=t;return(n/=s/2)<1?o/2*n*n+r:-o/2*((n-=1)*(n-2)-1)+r};(t=()=>{let c=+new Date-i;o.scrollTop=Number(l({currentTime:c,startVal:n,changeVal:a,animateDuration:e[s]})),c<e[s]?requestAnimationFrame(t):o.scrollTop=e[r]})()},o.useWillMount=e=>{"object"==typeof o&&t.typeOf(o,"HTMLDocument")?o.listener("readystatechange",({target:t})=>"interactive"===t.readyState&&e.call(e,t)):t.console("error","UseWillMount hook just use when selector document.")},o.useMounted=e=>{"object"==typeof o&&t.typeOf(o,"HTMLDocument")?o.listener("readystatechange",({target:t})=>"complete"===t.readyState&&e.call(e,t)):t.console("error","UseMounted Hook just use when selector document.")},o};t.each=(e,t)=>e.forEach((e,r)=>t.call(t,e,r)),t.maps=(e,t)=>e.map((e,r)=>t.call(t,e,r)),t.filter=(e,t)=>e.filter(e=>t.call(t,e)),t.find=(e,t)=>e.find(e=>t.call(t,e)),t.sort=(e,t)=>e.sort((e,r)=>t.call(t,e,r)),t.indexOf=(e,t)=>e.indexOf(t),t.includes=(e,t)=>e.includes(t),t.findIndexOfObj=(e,t)=>e.findIndex(e=>t.call(t,e)),t.findObjProperty=(e,t)=>e.hasOwnProperty(t),t.sum=(e,t,r)=>r?e.reduce((e,r)=>t.call(t,e,r),r):e.reduce((e,r)=>t.call(t,e,r)),t.mergeArray=(e,t,r)=>r?e.concat(t):r.call(r,e.concat(t)),t.typeOf=(e,t)=>t?e.constructor.name===t:e.constructor.name,t.console=(e,...t)=>console[e](...t),t.localData=(e,r,o)=>"get"===e?t.convert(localStorage.getItem(r),"json")||[]:localStorage.setItem(r,t.convert(o,"stringify")),t.getNumberOfDecimal=(e,t)=>parseInt(e.toFixed(t)),t.createCustomEvent=(e,t)=>t?new CustomEvent(e,{detail:t}):new CustomEvent(e),t.registerCustomEvent=(e,t)=>window.addEventListener(e,t),t.useCustomEvent=e=>window.dispatchEvent(e),t.removeCustomEvent=(e,t)=>window.removeEventListener(e,t),t.createPromise=e=>new Promise((t,r)=>e.call(e,t,r)),t.createPromiseAll=(...e)=>Promise.all(e),t.createDomText=e=>document.createTextNode(e),t.objDetails=(e,r)=>r&&t.includes(["keys","values","entries"],r)?Object[r](e):t.console("error","please enter secode prameter 'keys' or 'values' or 'entries' in type string"),t.useBase64=(e,t)=>"encode"===e?btoa(t):atob(t),t.useSHA=async(e,t)=>{let r=await window.crypto.subtle.digest(e,new TextEncoder().encode(t));return Array.from(new Uint8Array(r)).map(e=>e.toString(16).padStart(2,"0")).join("")},t.createArray=({type:e,item:r},o)=>{if("fake"===e){if("random"in r&&t.typeOf(r.random,"Number")&&void 0!==o&&t.typeOf(o,"Function"))return Array.from({length:r.random},(e,t)=>o.call(o,t));t.console("error","item property must have random in object and radom type must be number,with call back function in secode parameters.")}else if("new"===e&&!("random"in r))return Array.from(r)},t.convert=(e,r)=>{if(e&&r&&t.includes(["string","number","float","boolean","json","stringify"],r)){if(t.typeOf(e,"Object")&&t.includes(["string","number","float","boolean"],r)){t.console("error",`Convert value can't be object when use convert type ${r}.`);return}}else{t.console("error","Please enter first parameters value who want to convert and seconde paramters value is convert type 'string' or 'number' or 'float' or 'boolean' or 'json' or 'stringify'.");return}let o={string:String(e),number:parseInt(e),float:parseFloat(e),boolean:Boolean(e),json:"json"===r&&JSON.parse(e),stringify:"stringify"===r&&JSON.stringify(e)};return o[r]},t.createDom=(e,r)=>{let o=document.createElement(e),s=Object.entries(r);return t.each(s,e=>{let[r,s]=e;if(t.typeOf(s,"Object")){let[n,a]=e,[[i,l]]=Object.entries(a);o[n][i]=l}else o[r]=t.typeOf(s,"String")?s.trim():s}),o},t.currencyTranser=(e,r)=>{if(void 0!==e){let o=""===e?{}:{style:"currency",currency:e};return new Intl.NumberFormat(""===e?"TWN":e,o).format(r)}t.console("error","First argument currency type is must.")},t.formatDateTime=(e={formatDate:"",formatType:""})=>{if(!("formatDate"in e||"formatType"in e)){t.console("error","Please enter an object and use formatType property in the object.");return}if(t.findObjProperty(e,"customWeekItem")){if("Array"!==t.typeOf(e.customWeekItem)){t.console("error","customWeekItem property Must use array.");return}if(e.customWeekItem.length<=6||e.customWeekItem.length>7){t.console("error","customWeekItem property must put seven days name of week in array.");return}e.customWeekItem=[e.customWeekItem[e.customWeekItem.length-1],...e.customWeekItem],e.customWeekItem.pop()}let r=("localCountryTime"in e?e.localCountryTime:8)*36e5,o=new Date(+new Date(e.formatDate)+r).toJSON(),s=o.replace(/T/g,"-").replace(/:/g,"-").split(".")[0].split("-"),[n,a,i,l,c,u]=s;if("toDateFullNumber"in e)return t.convert(s.join(""),"number");if(e.formatType.match("tt")){let p=t.convert(l,"number")>11?"PM":"AM",d=t.convert(l,"number")-12<10?`0${t.convert(l,"number")-12}`:t.convert(t.convert(l,"number")-12,"string");return e.formatType.replace(/yyyy/g,n).replace(/MM/g,a).replace(/dd/g,i).replace(/HH/g,d).replace(/mm/g,c).replace(/ss/g,u).replace(/tt/g,p)}return t.findObjProperty(e,"customWeekItem")?{fullDateTime:e.formatType.replace(/yyyy/g,n).replace(/MM/g,a).replace(/dd/g,i).replace(/HH/g,l).replace(/mm/g,c).replace(/ss/g,u),getWeekName:e.customWeekItem[new Date(+new Date(e.formatDate)).getDay()]}:e.formatType.replace(/yyyy/g,n).replace(/MM/g,a).replace(/dd/g,i).replace(/HH/g,l).replace(/mm/g,c).replace(/ss/g,u)};class r{static #a="";static #b={};static{this.fetchSetting=async(e,o)=>{let s={},{method:n,headers:a,contentType:i,returnType:l,data:c,routeParams:u,queryParams:p,beforePost:d,successFn:m,excuteDone:y,errorFn:f}=e;s.method=n,e.url=r.#a?`${r.#a}${e.url}`:e.url;let h=l||"json";if(n){if(!t.includes(["get","post","patch","put","delete"],n.toLocaleLowerCase())){t.console("error","Method value must use valid request method,like get、post ...");return}}else{t.console("error","Property name method is required in obejct parameters.");return}if(u){let[g]=t.objDetails(u,"keys");e.url=`${e.url}/${u[g]}`}if(p){let b=t.maps(Object.entries(p),([e,t])=>`${e}=${t}`).join("&");e.url=`${e.url}?${b}`}if((t.objDetails(r.#b,"keys").length>0||a&&t.objDetails(a,"keys").length>0)&&(s.headers=t.objDetails(r.#b,"keys").length>0?r.#b:{"Content-Type":"application/json",...a}),c&&(s.headers=t.objDetails(r.#b,"keys").length>0?r.#b:{"Content-Type":i||"application/json"},s.body=t.convert(c,"stringify")),(t.objDetails(r.#b,"keys").length>0||a)&&c&&(s.headers=t.objDetails(r.#b,"keys").length>0?r.#b:{...a},s.body=t.convert(c,"stringify")),!o){if(d&&d.call(d),!m){t.console("error","Function Name successFn is required in obejct parameters.");return}if(!f){t.console("error","Function Name errorFn is required in obejct parameters.");return}}let v=await fetch(e.url,s);if(o)return new Promise(async(e,t)=>{if(v.status>=200&&v.status<400){let r=await v[h]();e({bodyUsed:v.bodyUsed,headers:v.headers,ok:v.ok,redirected:v.redirected,status:v.status,statusText:v.statusText,type:v.type,url:v.url,data:r})}else t({bodyUsed:v.bodyUsed,headers:v.headers,ok:v.ok,redirected:v.redirected,status:v.status,statusText:v.statusText,type:v.type,url:v.url})});try{if(v.status>=200&&v.status<400){let T=await v[h]();m.call(m,{bodyUsed:v.bodyUsed,headers:v.headers,ok:v.ok,redirected:v.redirected,status:v.status,statusText:v.statusText,type:v.type,url:v.url,data:T}),y&&y.call(y)}else throw Error(JSON.stringify({bodyUsed:v.bodyUsed,headers:v.headers,ok:v.ok,redirected:v.redirected,status:v.status,statusText:v.statusText,type:v.type,url:v.url}))}catch(j){f.call(f,JSON.parse(j.message))}},this.createBase=({baseUrl:e,baseHeaders:t})=>{r.#a=e,r.#b=t}}}class o extends r{static{this.get=(e,t)=>this.fetchSetting({method:"get",url:e,...t},!0),this.post=(e,t)=>this.fetchSetting({method:"post",url:e,...t},!0),this.patch=(e,t)=>this.fetchSetting({method:"patch",url:e,...t},!0),this.put=(e,t)=>this.fetchSetting({method:"put",url:e,...t},!0),this.delete=(e,t)=>this.fetchSetting({method:"delete",url:e,...t},!0)}}return t.fetch=(e={method:"",url:"",headers:{},contentType:"",returnType:"",routeParams:{},queryParams:{},data:{},beforePost:void 0,successFn:void 0,excuteDone:void 0,errorFn:void 0})=>r.fetchSetting(e,!1),t.fetch.get=(e,t={headers:{},returnType:"",routeParams:{},queryParams:{}})=>o.get(e,t),t.fetch.post=(e,t={headers:{},data:{},returnType:"",routeParams:{},queryParams:{}})=>o.post(e,t),t.fetch.patch=(e,t={headers:{},data:{},returnType:"",routeParams:{},queryParams:{}})=>o.patch(e,t),t.fetch.put=(e,t={headers:{},data:{},returnType:"",routeParams:{},queryParams:{}})=>o.put(e,t),t.fetch.delete=(e,t={headers:{},data:{},returnType:"",routeParams:{},queryParams:{}})=>o.delete(e,t),t.fetch.createBase=(e={baseUrl:"",baseHeaders:{}})=>r.createBase(e),t})(e=>"object"==typeof e?e:document.querySelectorAll(e).length>1?document.querySelectorAll(e):document.querySelector(e));Math.toFixedNum=(e={value,toFloatPos})=>{if(!e||!$.findObjProperty(e,"value")||!$.findObjProperty(e,"toFloatPos")){$.console("error","Please use object and with key value pair. ex: { value:100.1,toFloatPos:1 }");return}if(!$.typeOf(e.toFloatPos,"Number")){$.console("error","toFloatPos key must use number.");return}return $.typeOf(e.value,"String")?Number(parseFloat(e.value).toFixed(e.toFloatPos)):Number(e.value.toFixed(e.toFloatPos))},String.prototype.appendText=function(e){return this.toString()+e},String.prototype.appendDirection=function(e,t,r){return this["left"===e?"padStart":"padEnd"](t,r)},String.prototype.range=function(e,t){return this.toString().slice(e,t)},String.prototype.format=function(e,...t){if($.typeOf(e,"String")&&$.includes(e,"{")&&$.includes(e,"}")){if(e.split("{").join("").split("}").length-1===t.length){let r=e,o=$.maps(t,(e,t)=>({replaceKey:`{${t}}`,replaceValue:e})),s=$.maps(o,({replaceKey:e,replaceValue:t})=>r=r.replace(e,t)).range(o.length-1,o.length).join("");return s}$.console("error","Can't not find else aguments.")}else $.console("error","First paramter must use type string,if use string must like this ex：abc {0} efg {1}.")},Date.prototype.calculateDay=function(e){if(e&&"day"in e&&"method"in e){if("number"!=typeof e.day){$.console("error","day property must use type number.");return}if(!$.includes(["addDay","reduceDay"],e.method)){$.console("error","Please enter method type 'addDay' or 'reduceDay'.");return}}else{$.console("error","Please enter an object and use day and method property in the object.");return}return({addDay:new Date(+this+864e5*e.day),reduceDay:new Date(+this-864e5*e.day)})[e.method]},Date.prototype.getLocalTimeZone=function(){return Math.abs(this.getTimezoneOffset()/60)},Date.prototype.toOptionTimeZoneForISO=function(e){return e?new Date(+this+36e5*e).toISOString():$.console("error","Lost one parameter in function.")},Array.prototype.append=function(e){this.push(e)},Array.prototype.appendFirst=function(e){return this.unshift(e),this},Array.prototype.range=function(e,t){return this.slice(e,t)},Array.prototype.remove=function(e){return this.splice(e,1),this},Array.prototype.removeFirst=function(){return this.shift(),this},Array.prototype.removeLast=function(){return this.pop(),this},Map.prototype.append=function(e,t){this.set(e,t)},Map.prototype.getValue=function(e){return this.get(e)},Map.prototype.deleteKeyValue=function(e){return this.delete(e)},Map.prototype.removeAll=function(){this.clear()},Map.prototype.isKeyInMap=function(e){return this.has(e)},Map.prototype.toObject=function(){return Object.fromEntries(this)},Set.prototype.append=function(e){this.add(e)},Set.prototype.deleteValue=function(e){return this.delete(e)},Set.prototype.isValueInSet=function(e){return this.has(e)},Set.prototype.removeAll=function(){this.clear()},Set.prototype.toArray=function(){return[...this]},Object.prototype.toMap=function(e){return new Map(Object.entries(e))};